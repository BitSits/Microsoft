<html dir="LTR"><head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><meta name="MS.LOCALE" content="en-us"><title> Don't Let the Defense Rest: Securing Home Networks with Windows XP</title><meta name="description" content="How to enable Internet Connection Firewall (ICF) and how to manually configure port settings to permit file transfer when using Windows Messenger and ICF."><meta name="keywords" content="Microsoft Windows XP Professional, Home Edition, Whistler, Internet Connection Firewall, networking, Windows Messenger"><meta name="search.mnp.template" content="MNP2.GenericArticle"><link type="text/css" rel="Stylesheet" href="bowman_november12.mspx_files/templatecss.css"><style>
          #contentTableDIV{padding: 0px 15px 0px 20px}
        </style><meta name="keywords" content="Microsoft Windows XP Professional, Home Edition, Whistler, Internet Connection Firewall, networking, Windows Messenger" xmlns="http://www.microsoft.com/MSCOM/MNP2/Schemas"><meta name="description" content="How to enable Internet Connection Firewall (ICF) and how to manually configure port settings to permit file transfer when using Windows Messenger and ICF." xmlns="http://www.microsoft.com/MSCOM/MNP2/Schemas"><meta name="updatedDate" content="2003-08-15" xmlns="http://www.microsoft.com/MSCOM/MNP2/Schemas"><meta name="title" content=" Don't Let the Defense Rest: Securing Home Networks with Windows XP" xmlns="http://www.microsoft.com/MSCOM/MNP2/Schemas"><meta name="pageTitle" content="Don't Let the Defense Rest: Securing Home Networks with Windows XP" xmlns="http://www.microsoft.com/MSCOM/MNP2/Schemas"><meta name="owner" content="Microsoft Corporation" xmlns="http://www.microsoft.com/MSCOM/MNP2/Schemas"><meta name="author" content="Microsoft" xmlns="http://www.microsoft.com/MSCOM/MNP2/Schemas"><meta name="migratedFrom" content="http://www.microsoft.com/windowsxp/expertzone/columns/bowman/november12.asp" xmlns="http://www.microsoft.com/MSCOM/MNP2/Schemas">
<link type="text/css" rel="Stylesheet" href="bowman_november12.mspx_files/css.css">
<script type="text/javascript" language="Javascript" src="bowman_november12.mspx_files/menujs"></script>
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"><link rel="stylesheet" type="text/css" href="bowman_november12.mspx_files/css_002.css"><script language="JavaScript">var doImage=doImage;var TType=TType;var defaultSearchLable;
function mhHover(tbl,idx,cls){var t,d;if(document.getElementById)t=document.getElementById(tbl);else t=document.all(tbl);if(t==null)return;if(t.getElementsByTagName)d=t.getElementsByTagName("TD");else d=t.all.tags("TD");if(d==null)return;if(d.length<=idx)return;d[idx].className=cls;}
function footerjs(doc){if(doImage==null){var tt=TType==null?"PV":TType;doc.write('<layer visibility="hide"><div style="display:none"><img src="http://c.microsoft.com/trans_pixel.asp?source=www&TYPE=' + tt + '&p=windowsxp_using_networking_expert_bowman&URI=%2fwindowsxp%2fusing%2fnetworking%2fexpert%2fbowman_november12.mspx&GUID=1F4FC18C-F71E-47FB-8FC9-612F8EE59C61&r=http%3a%2f%2fwww.microsoft.com%2fwindowsxp%2fusing%2fnetworking%2fexpert%2fbowman_02april08.mspx&lc=en-us" width=0 height=0 hspace=0 vspace=0 border=0 alt=""/></div></layer>');}}
var rsltextbox = 'msviLSBtbox'; var wtflag = false;
function stripSymbols () { var objrslttextbox = getObjectById(rsltextbox); if (objrslttextbox) { var form = objrslttextbox.form; var s = objrslttextbox.value; filteredValues = "<>!@^*"; var i; var returnString = ""; for (i = 0; i < s.length; i++) { var c = s.charAt(i); if (filteredValues.indexOf(c) == -1) { returnString += c; } else { returnString += " "; } } objrslttextbox.value = returnString; } if(!wtflag) { trackLSB("Site"); } } 
function addSubmitEvent() {
 msviLSBtbox=document.getElementById("msviLSBtbox")
 if(msviLSBtbox)
 {
    defaultSearchLable = msviLSBtbox.value;
 }
 var objrslttextbox = getObjectById(rsltextbox); 
 if (objrslttextbox) 
 { 
    var form = objrslttextbox.form;
     if (window.attachEvent) 
     { 
         form.attachEvent("onsubmit",stripSymbols); 
     }
     else 
     { 
        form.addEventListener("submit",stripSymbols,false);
     }
  } 
} 
function getObjectById(elid) 
{ 
    if (document.getElementById) 
    { 
        return document.getElementById(elid); 
    } 
    else if (document.all) 
    { 
        return document.all[elid]; 
    } 
    else if (document.layers) 
    { 
        return document.layers[elid];
    } 
} 
if (window.attachEvent) { window.attachEvent("onload",addSubmitEvent); } else { window.addEventListener("load",addSubmitEvent,false); } 
var FromWeb = false;
function trackLSB(type)
{

  clearDefaultSearchLable();
 
  if(type=="Web")
    FromWeb = true;
  var tmp = document.getElementById("msviLSBtbox");
  var errorInfo = document.getElementById("errorInfo");
  if(type=="Site" && tmp.value.length==0 && !FromWeb)
  {
       tmp.value=errorInfo.value;
       tmp.style.color='#bc2b2b';
       ajustWidth();
  }
  if (typeof dcsMultiTrack == "function")
  { 
      var qu = document.getElementById("msviLSBtbox").value;
      var dcsuri = "results.aspx";
      var dcssip, ti;
      if (type == "Site")
      {
        dcssip = "search.microsoft.com";
        ti = "SearchButton: OnSite"; 
      }
      else if (type == "Web")
      {
         dcssip = "bing.com";
         ti = "SearchButton: Web";
      }
      dcsMultiTrack("DCS.dcsuri", dcsuri, "DCS.dcssip", dcssip, "WT.ti", ti, "WT.dl", "2", "WT.z_srch_t", qu, "DCS.dcsqry", "", "WT.ad", "", "WT.mc_id", ""); 
      wtflag = true; DCS.dcsuri=DCS.dcssip=DCS.dcsqry=WT.ti=WT.z_srch_t="";
  }
}

var isInputqu = false;
var searchBoxWidthWithKievLogo = 0;
var searchBoxWidthWithoutKievLogo = 0;
function clearDefaultSearchLable()
{var searchBox = document.getElementById("msviLSBtbox");
if(!isInputqu){searchBox.value = "";}}
var kievImageWidth = 47;
var isAdTboxWidth = false;
var isInitailed = false;
function ajustWidth()
{
    var searchBoxInput = document.getElementById("msviLSBtbox");
    var kievImage = document.getElementById("msviLSBlogo");
    if(!isInitailed)
    {
         searchBoxWidthWithKievLogo = searchBoxInput.style.width;
         searchBoxWidthWithoutKievLogo = searchBoxInput.clientWidth + (kievImageWidth - 1);
         isInitailed = true;
    }
    var width = kievImage.clientWidth-1;
    kievImage.style.width = '1px';
    var tBoxAloneWidth = searchBoxInput.clientWidth + width;
    searchBoxInput.style.width = tBoxAloneWidth;
    isAdTboxWidth = true;
    
      
    
}

function searchBoxFocused(defaultSearchLabel)
{
    var searchBoxInput = document.getElementById("msviLSBtbox");
    var kievImage = document.getElementById("msviLSBlogo");
    if(searchBoxInput.value == defaultSearchLabel || searchBoxInput.value==document.getElementById("errorInfo").value)
    {
        searchBoxInput.value = '';
        searchBoxInput.style.fontStyle = '';
        searchBoxInput.style.color='#000000';
        kievImage.style.width = '1px';
        if(searchBoxWidthWithKievLogo == 0 && !isAdTboxWidth &&!isInitailed)
        {
            searchBoxWidthWithKievLogo = searchBoxInput.style.width;
            searchBoxWidthWithoutKievLogo = searchBoxInput.clientWidth + (kievImageWidth - 1);
            isInitailed = true;
        }
        searchBoxInput.style.width = searchBoxWidthWithoutKievLogo;
    }
}

function searchBoxBlur(defaultSearchLabel)
{
    var searchBoxInput = document.getElementById("msviLSBtbox");
    var kievImage = document.getElementById("msviLSBlogo");
    if(searchBoxInput.value.replace(/(^\s*)|(\s*$)/g, '')=='') 
    {
        searchBoxInput.value=defaultSearchLabel;searchBoxInput.style.fontStyle ='Italic';
        searchBoxInput.style.color = "#a1a1a1";
        kievImage.style.width = kievImageWidth;
        
        searchBoxInput.style.width = searchBoxWidthWithKievLogo;
        isInputqu = false;
     }
     else
     {
        isInputqu = true;
     }
}

function Test()
{
    var searchBox = document.getElementById(rsltextbox);
    var go = document.getElementById("errorInfo");
    if(searchBox.value==go.value)
        return false;
    return true; 
}</script><meta name="WT.sp" content="_windowsxp_using_"><script language="JavaScript" src="bowman_november12.mspx_files/broker.js"></script><script language="Javascript">
					if (self.name == "MNPMainFrame") top.location.href = self.location.href;
				</script><meta name="save" content="favorite"></head><body topmargin="0" leftmargin="0" bgcolor="#ffffff" marginheight="0" marginwidth="0"><!--NOINDEX_START--><a name="top"></a><div id="msviMasthead"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td width="100%"><table width="100%" border="0" cellpadding="0" cellspacing="0" height="22"><tbody><tr><td id="msviMarketing" bgcolor="#ffffff" nowrap="nowrap"><a href="http://go.microsoft.com/fwlink/?LinkID=92799">Click Here to Install Silverlight</a></td><td width="100%" bgcolor="#6487db"><img src="bowman_november12.mspx_files/gradient.jpg" alt="*" title="" width="250" height="22"></td></tr></tbody></table></td><td id="msviGlobalToolbar" dir="ltr" align="left" bgcolor="#6487db" height="22" nowrap="nowrap"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td id="msviRegionId" nowrap="nowrap">United States</td><td id="msviRegionSelector" nowrap="nowrap"><a href="http://www.microsoft.com/worldwide">Change</a></td><td class="gtsep">|</td><td id="msviSiteMap" nowrap="nowrap"><a href="http://www.microsoft.com/en/us/sitemap.aspx">All Microsoft Sites</a></td><td><span class="gtsep">|</span></td><td class="msviPassport" nowrap="nowrap"><a id="idPPScarab" href="http://login.live.com/logout.srf?ct=1282355845&amp;rver=6.0.5276.0&amp;lc=1033&amp;id=74335&amp;ru=http:%2F%2Fwww.microsoft.com%2Fwindowsxp%2Fusing%2Fnetworking%2Fexpert%2Fbowman_november12.mspx"><span id="idSOT">Sign out</span></a></td></tr></tbody></table></td></tr></tbody></table><table width="100%" border="0" cellpadding="0" cellspacing="0"><tbody><tr valign="top"><td><table style="" width="100%" border="0" cellpadding="0" cellspacing="0" height="42"><tbody><tr valign="top"><td id="msviBrandBanner" bgcolor="#ffffff"><a href="http://www.microsoft.com/windowsxp"><img src="bowman_november12.mspx_files/windowsXP_masthead_ltr.gif" alt="Windows XP" title="" width="225" border="0" height="42"></a></td></tr></tbody></table></td><td id="msviGlobalSearch" width="100%" bgcolor="#b6c5ee"><div class="msviLSBsform"><form id="msviLSBForm" action="/library/toolbar/3.0/search.aspx" target="_top"><div id="msKiev"><input name="View" value="en-us" type="hidden"><input name="charset" value="iso-8859-1" type="hidden"><input id="msviLSBtbox" style="font-style: italic; color: rgb(161, 161, 161);" onkeydown="if(event.keyCode == 13)searchBoxBlur('Search Microsoft.com')" onfocus="searchBoxFocused('Search Microsoft.com')" onblur="searchBoxBlur('Search Microsoft.com')" name="qu" value="Search Microsoft.com" autocomplete="off" type="text"><span id="msviLSBlogo" class="msviLSBlogo" title="Results by Bing"></span><input id="msviLSBssearch" title="Search Microsoft.com" name="site" src="bowman_november12.mspx_files/Search_icon.gif" onclick="trackLSB('Site')" align="absmiddle" type="image"></div><input id="msviLSBWeb" title="Search the Web" name="sweb" value="" onclick="trackLSB('Web')" align="absmiddle" type="submit"></form></div></td></tr></tbody></table><div id="msviLocalToolbar"><table width="100%" border="0" cellpadding="0" cellspacing="0" height="19"><tbody><tr><td id="msviHomePageLink" nowrap="nowrap"><a href="http://www.microsoft.com/windowsxp/default.mspx">Windows XP Home</a></td><td><span class="ltsep">|</span></td><td class="lt0" onmouseover="mhHover('msviLocalToolbar', 2, 'lt1')" onmouseout="mhHover('msviLocalToolbar', 2, 'lt0')" nowrap="nowrap"><a href="http://www.microsoft.com/athome/security/default.mspx">Security At Home</a></td><td><span class="ltsep">|</span></td><td class="lt0" onmouseover="mhHover('msviLocalToolbar', 4, 'lt1')" onmouseout="mhHover('msviLocalToolbar', 4, 'lt0')" nowrap="nowrap"><a href="http://www.microsoft.com/athome/default.mspx">Microsoft At Home</a></td><td><span class="ltsep">|</span></td><td class="lt0" onmouseover="mhHover('msviLocalToolbar', 6, 'lt1')" onmouseout="mhHover('msviLocalToolbar', 6, 'lt0')" nowrap="nowrap"><a href="http://www.microsoft.com/atwork/default.mspx">Microsoft At Work</a></td><td width="100%"></td></tr></tbody></table></div></div><table width="100%" border="0" cellpadding="0" cellspacing="0"><tbody><tr valign="top"><td style="overflow-x: hidden;" width="181" height="100%"><div id="mnpMenuTop" class="mnpMenuTop" style="overflow-x: hidden; width: 181px;" url="/windowsxp/using/networking/expert/bowman_november12.mspx" dir="LTR" parent="/windowsxp/using/networking/default.mspx"><div class="mnpInherit"><div class="mnpMenuLabel">Windows XP Editions</div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/home/default.mspx">Home Edition</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/pro/default.mspx">Professional</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/mediacenter/default.mspx">Media Center Edition</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/tabletpc/default.mspx">Tablet PC Edition</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/64bit/default.mspx">Professional x64 Edition</a></div><div class="mnpMenuBorder" style="width: 180px;"></div><div class="mnpMenuLabel">Information For</div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/homeusers/defaultm.mspx">Home Users</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/students/default.mspx">Students</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/business/default.mspx">Small Businesses</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/technet/prodtechnol/winxppro/default.mspx">IT Professionals</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://msdn2.microsoft.com/en-us/library/aa286545">Developers</a></div><div class="mnpMenuBorder" style="width: 180px;"></div><div class="mnpMenuLabel">Resources</div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;" menu="m90f0c3765598a8f6d936ceb105f60def"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/using/default.mspx">Using Windows XP</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;" menu="m0ab75ea5c65258a4d0f711a14581bde7"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/downloads/default.mspx">Downloads</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/support/default.mspx">Support</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;" menu="m79bcb962cfe9a15079154b3f186bd916"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/expertzone/default.mspx">Expert Zone</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windowsxp/worldwide/default.mspx">Worldwide Sites</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://update.microsoft.com/microsoftupdate/">Microsoft Update</a></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.windowsmarketplace.com/">Windows Marketplace</a></div><div class="mnpMenuBorder" style="width: 180px;"></div><div class="mnpMenuRow" style="border-color: rgb(241, 241, 241); background: rgb(241, 241, 241) none repeat scroll 0% 0%; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous; width: 153px; overflow-x: hidden;" menu="m830408569122205f4691f65de881aef3"><img alt="*" title="" class="mnpMenuArrow" src="bowman_november12.mspx_files/arrowLTR.gif" style="left: 166px; visibility: hidden;" width="4" border="0" height="7"><a href="http://www.microsoft.com/windows/default.asp">Windows Family</a></div><div class="mnpMenuBorder" style="width: 180px; margin-bottom: 0px;"></div></div></div><div class="mnpAds" style="border-style: solid; border-color: rgb(153, 153, 153); border-width: 0px 1px 0px 0px; background: rgb(241, 241, 241) none repeat scroll 0% 0%; width: 181px; height: 100%; padding-bottom: 20px; -moz-background-clip: border; -moz-background-origin: padding; -moz-background-inline-policy: continuous;"><center><script type="text/javascript" src="bowman_november12.mspx_files/dap.js"></script><div id="CMSCX5" style="background: inherit inherit inherit inherit inherit; padding-top: 20px; -moz-background-clip: inherit; -moz-background-origin: inherit; -moz-background-inline-policy: inherit;"><iframe src="bowman_november12.mspx_files/a.htm" name="dapIfM0" id="dapIfM0" width="120" frameborder="0" height="90" scrolling="no"></iframe></div><script type="text/javascript">dapMgr.enableACB("CMSCX5", false);dapMgr.renderAd("CMSCX5", "&PG=CMSCX5&SC=F2&AP=1027",120,90);
    </script></center></div></td><td dir="LTR" width="100%">
<table class="bodyTable" width="100%" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td valign="top"><table class="containerTable" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td><div id="contentTableDIV"><div class="ancestorLinks"><nobr><a href="http://www.microsoft.com/windowsxp/using/default.mspx">Using Windows XP</a>
        &gt;
      </nobr><nobr><a href="http://www.microsoft.com/windowsxp/using/networking/default.mspx">Home and Small Business Networking</a></nobr></div><h1>Don't Let the Defense Rest: Securing Home Networks with Windows XP</h1><div class="date">Updated: August 15, 2003</div><div class="byline">By Barb Bowman, Windows XP Expert Zone Community Columnist</div><div style="height: 18px;"></div><table class="sideContainer" style="margin-left: 15px;" width="165" align="right" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td><table dir="LTR" class="containerHeader" width="165" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td align="left"><img src="bowman_november12.mspx_files/l_corner.gif" alt="*" title="" width="2" border="0" height="3"></td><td align="right"><img src="bowman_november12.mspx_files/r_corner.gif" alt="*" title="" width="2" border="0" height="3"></td></tr></tbody></table><div style="padding: 8px 7px; width: 165px;" class="sidebarContent"><h5>Related Links</h5><table style="margin-top: 10px; margin-bottom: -2px;" class="relatedLinksContainer" border="0" cellpadding="0" cellspacing="0"><tbody><tr valign="top"><td class="rlBullet">&#8226;</td><td class="relatedLink"><a href="http://www.microsoft.com/windowsxp/expertzone/newsgroups/reader.mspx">Ask questions or discuss this topic in the Windows XP Expert Zone Newsgroups</a></td></tr><tr valign="top"><td class="rlBullet">&#8226;</td><td class="relatedLink"><a href="http://www.microsoft.com/technet/prodtechnol/winxppro/evaluate/xpsec.mspx">What's New in Security for Windows&nbsp;XP Professional and Windows&nbsp;XP Home Edition</a></td></tr><tr valign="top"><td class="rlBullet">&#8226;</td><td class="relatedLink"><a href="http://www.microsoft.com/technet/prodtechnol/winxppro/support/upnp01.mspx">UPnP NAT Traversal FAQ</a></td></tr><tr valign="top"><td class="rlBullet">&#8226;</td><td class="relatedLink"><a href="http://www.microsoft.com/windowsxp/expertzone/newsgroups/reader.mspx?dg=microsoft.public.windowsxp.security_admin">Windows XP Security and Administration Newsgroup</a></td></tr><tr valign="top"><td class="rlBullet">&#8226;</td><td class="relatedLink"><a href="http://www.microsoft.com/windowsxp/expertzone/newsgroups/reader.mspx?dg=microsoft.public.windowsxp.network_web">Windows XP Networking and the Web newsgroup</a></td></tr><tr valign="top"><td class="rlBullet">&#8226;</td><td class="relatedLink"><a href="http://www.microsoft.com/windowsxp/expertzone/meetexperts/bowman.mspx">Previous columns by Barb Bowman</a></td></tr></tbody></table></div><table dir="LTR" class="containerFooter" width="165" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td align="left"><img src="bowman_november12.mspx_files/l_b.gif" alt="*" title="" width="2" border="0" height="3"></td><td align="right"><img src="bowman_november12.mspx_files/r_b.gif" alt="*" title="" width="2" border="0" height="3"></td></tr></tbody></table></td></tr></tbody></table><p><i>Editor's
Note: Past articles by members of the online community are archived for
your use. The information may become outdated as technology changes.
For the most current information, please search the Web site or post a
question in the newsgroups.</i></p><img src="bowman_november12.mspx_files/hs_bowman_lg.jpg" alt="Barb Bowman" title="Barb Bowman" class="nearGraphic" width="120" align="left" border="0" height="160"><p>It's
sad, but true&#8212;there are some not so nice people out there, and that
includes Internet abusers who want to wreak havoc on your computer and
make your life miserable. While just about everyone on the planet has a
good anti&#8211;virus program installed these days, this type of protection
may not be enough. So, what should your first line of defense be? A
firewall can stop invaders from gaining access to your computer. In
essence, a firewall provides protection from port scanning and disables
access to shared folders, files, and printers, which keeps the bad guys
from copying files and programs to your computer that can cause serious
problems when executed.</p><p>A good rule of thumb is that any computer
connected directly to the Internet should also be protected by a
firewall. A personal firewall can be your ticket to strong intruder
protection and peace of mind.</p><br style="font-size: 0pt;" clear="left"><table class="pullQuote" width="175" align="left" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td><div class="pullQuoteRule1"></div><table class="pullQuoteContent" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="startQuote" valign="top"><img src="bowman_november12.mspx_files/1quote.gif" alt="*" title="" width="17" border="0" height="13"></td><td class="directQuote">A
good rule of thumb is that any computer connected directly to the
Internet should also be protected by a firewall. A personal firewall
can be your ticket to strong intruder protection and peace of mind. </td><td class="endQuote" valign="bottom"><img src="bowman_november12.mspx_files/2quote.gif" alt="*" title="" width="17" border="0" height="12"></td></tr><tr><td></td><td class="citation"><span class="citationAuthor">&nbsp;</span><br></td><td></td></tr></tbody></table><div class="pullQuoteRule2"></div></td></tr></tbody></table><p>And
now for the good news! If you are running Microsoft Windows XP
Professional or Home Edition, Windows XP Media Center Edition, or
Windows XP Tablet PC Edition, you've already got access to a built&#8211;in
basic firewall. Microsoft <b>Internet Connection Firewall</b> (ICF) is
included as a Windows XP networking feature and you should enable it if
you need firewall protection. (If you've set up your Internet
connection using the wizard and selected a direct or dial&#8211;up connection
to the Internet, ICF may already be enabled.)</p><p>When running
Windows XP, ICF opens and closes most ports on the firewall dynamically
as you access services but there are a few exceptions. (See the <a href="http://www.microsoft.com/windowsxp/expertzone/columns/bowman/November12.asp#ICF">Windows Messenger and ICF</a>
section below for details on manually configuring ports to enable file
transfer and voice calls). Since Internet Connection Firewall provides
inbound protection only, if you have concerns about programs that
&#8220;phone home&#8221; or send outbound data to an unknown destination over the
Internet, you may want to consider a third&#8211;party firewall.</p><a name="EEC"></a><h2>Who Needs Firewall Protection?</h2><p>You
need protection if you have a direct, dial&#8211;up connection to the
Internet, a single computer connected to a cable modem, or a single
computer connected to a DSL modem. You'll also want to enable a
firewall on the Windows XP&#8211;based host computer (and only the host
computer) that is used for Internet Connection Sharing (ICS). If you're
a broadband user with two or more ISP assigned IPs connected through a
hub, you'll need to protect <b>each</b> computer individually. An easy rule of thumb&#8212;if a computer connects directly to the Internet, it needs protection.</p><p>To activate ICF:</p><table class="numberedList" border="0" cellpadding="0" cellspacing="0"><tbody><tr valign="top"><td class="listNumber" align="right" nowrap="nowrap"><p>1.</p></td><td><p>Click <b>Start</b>, and then click <b>My Network Places</b>. </p></td></tr><tr valign="top"><td class="listNumber" align="right" nowrap="nowrap"><p>2.</p></td><td><p>Under <b>Network Tasks</b>, click <b>View Network Connections</b>. (Alternatively, you can right&#8211;click <b>My Network Places</b> and then click <b>Properties</b>.) </p></td></tr><tr valign="top"><td class="listNumber" align="right" nowrap="nowrap"><p>3.</p></td><td><p>Right&#8211;click the connection used for the Internet, and then click <b>Properties</b>. </p></td></tr><tr valign="top"><td class="listNumber" align="right" nowrap="nowrap"><p>4.</p></td><td><p>Click the <b>Advanced</b> tab, and select the <b>Protect my computer and network</b> check box to turn on ICF. (This also makes the <b>Settings</b> button active, allowing you to configure advanced parameters.) </p><p><img src="bowman_november12.mspx_files/icf1.jpg" alt="Wireless Network Connections Properties dialog box &#8211; Advanced tab" width="363" border="0" height="411"></p></td></tr></tbody></table><div style="margin-top: 3px; margin-bottom: 10px;"><a href="#top"><img src="bowman_november12.mspx_files/arrow_px_up.gif" alt="Top of page" width="7" border="0" height="9"></a><a class="topOfPage" href="#top">Top of page</a></div><a name="E3D"></a><h2>Windows Messenger and ICF</h2><p>Most
of the time, my computers are connected wirelessly through one of my
Network Address Translation (NAT) boxes that is connected to an
AT&amp;T Broadband cable modem. I'm waiting for UPnP firmware for these
units that will enable Nat traversal so I can use all of the features
of programs like Windows Messenger behind them. (Voice and video
instant messaging were not working behind these NAT boxes when I wrote
this column, but I'm hoping for firmware that will make this possible
and when it arrives, I'll share information on the new UPnP NAT
capabilities here in the Expert Zone.) When I wish to use the voice and
video instant messaging real time communications (RTC) features, I
connect a computer directly to my cable modem, and I enable the
Internet Connection Firewall for these sessions.</p><p>Windows Messenger version 4.0, which ships with Windows XP, as well as the updated <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=b475d2d1-6266-4d82-bf78-14597545a6b4&amp;displaylang=en">Windows Messenger&nbsp;4.7</a>
that is now available, also include the ability to transfer files.
However, by default, ICF blocks file transfer and you will need to
manually configure the appropriate ports to open. Here's how it's
accomplished:</p><table class="numberedList" border="0" cellpadding="0" cellspacing="0"><tbody><tr valign="top"><td class="listNumber" align="right" nowrap="nowrap"><p>1.</p></td><td><p>Click <b>Settings</b> on the <b>Advanced</b> tab of the Properties dialog box for your Internet connection, then click <b>Add</b>. </p><p><img src="bowman_november12.mspx_files/icf2.gif" alt="Service Settings windows" width="360" border="0" height="300"></p></td></tr><tr valign="top"><td class="listNumber" align="right" nowrap="nowrap"><p>2.</p></td><td><p>In the <b>Service Settings</b> window, type a description of the service. </p></td></tr><tr valign="top"><td class="listNumber" align="right" nowrap="nowrap"><p>3.</p></td><td><p>Type the IP address or the computer name. </p></td></tr><tr valign="top"><td class="listNumber" align="right" nowrap="nowrap"><p>4.</p></td><td><p>For
Windows Messenger file transfer capabilities, the External and Internal
Ports are the same and both are TCP. Use 6891 for both. If you wish to
enable simultaneous transfer of up to 10 files, after clicking OK, set
up additional ports in the same manner, numbering sequentially through
6900. You'll need 10 service entries total. </p></td></tr></tbody></table><p>Additionally,
you will have open Port 6901 for both TCP and UDP to receive incoming
computer to computer voice calls and UDP Ports 6801, 6901, 2001&#8211;2120
for computer to phone voice calls.</p><p><img src="bowman_november12.mspx_files/icf3.gif" alt="Advanced Settings dialog box &#8211; Services tab" width="363" border="0" height="411"></p><p>As
shown in the image above, I've enabled a single port only for a single
file transfer only. The process to open ports to add other services is
the same. Settings needed for some of the other more popular programs
appear in the table below:</p><table class="dataTable" id="EGF" cellpadding="0" cellspacing="0"><thead><tr class="stdHeader" valign="top"><td id="colEIF" width="42%">Program</td><td id="colEMF" width="30%">TCP ports</td><td id="colEQF" style="border-right: 1px solid rgb(204, 204, 204);" width="28%">UDP ports</td></tr></thead><tbody><tr class="record" valign="top"><td><p class="lastInCell">Incoming Voice (computer to computer)</p></td><td><p class="lastInCell">6901</p></td><td style="border-right: 1px solid rgb(204, 204, 204);"><p class="lastInCell">6901</p></td></tr><tr class="evenRecord" valign="top"><td><p class="lastInCell">Voice (computer to phone)</p></td><td><p class="lastInCell">&nbsp;</p></td><td style="border-right: 1px solid rgb(204, 204, 204);"><p class="lastInCell">6801, 6901, 2001&#8211;2120</p></td></tr><tr class="record" valign="top"><td><p class="lastInCell">AOL Instant Messenger</p></td><td><p class="lastInCell">443, 563</p></td><td style="border-right: 1px solid rgb(204, 204, 204);"><p class="lastInCell">&nbsp;</p></td></tr><tr class="evenRecord" valign="top"><td><p class="lastInCell">Crimson Skies</p></td><td><p class="lastInCell">28805, 28801, 3040, 1121</p></td><td style="border-right: 1px solid rgb(204, 204, 204);"><p class="lastInCell">&nbsp;</p></td></tr><tr class="record" valign="top"><td><p class="lastInCell">Decent 3</p></td><td><p class="lastInCell">1900</p></td><td style="border-right: 1px solid rgb(204, 204, 204);"><p class="lastInCell">1900, 2092</p></td></tr><tr class="evenRecord" valign="top"><td><p class="lastInCell">Diablo II</p></td><td><p class="lastInCell">4000</p></td><td style="border-right: 1px solid rgb(204, 204, 204);"><p class="lastInCell">6112</p></td></tr><tr class="record" valign="top"><td><p class="lastInCell">Need for Speed</p></td><td><p class="lastInCell">9442</p></td><td style="border-right: 1px solid rgb(204, 204, 204);"><p class="lastInCell">6112</p></td></tr><tr class="evenRecord" valign="top"><td><p class="lastInCell">Napster</p></td><td><p class="lastInCell">6699</p></td><td style="border-right: 1px solid rgb(204, 204, 204);"><p class="lastInCell">6699</p></td></tr><tr class="record" valign="top"><td><p class="lastInCell">NetMeeting</p></td><td><p class="lastInCell">1731, 1720, 1503, 522, 389</p></td><td style="border-right: 1px solid rgb(204, 204, 204);"><p class="lastInCell">&nbsp;</p></td></tr><tr class="evenRecord" valign="top"><td><p class="lastInCell">Rainbow Six</p></td><td><p class="lastInCell">2346, 2347, 2348</p></td><td style="border-right: 1px solid rgb(204, 204, 204);"><p class="lastInCell">&nbsp;</p></td></tr></tbody></table><div class="dataTableBottomMargin"></div><div style="margin-top: 3px; margin-bottom: 10px;"><a href="#top"><img src="bowman_november12.mspx_files/arrow_px_up.gif" alt="Top of page" width="7" border="0" height="9"></a><a class="topOfPage" href="#top">Top of page</a></div><a name="E2H"></a><h2>Security Logging and Trouble Shooting</h2><p>If you want to examine incoming connection attempts, you can turn on logging from the ICF <b>Advanced Settings</b>
tab as well as specify the size of a log file. If you're experiencing
connectivity issues and need to trouble shoot your connection, the <b>ICMP</b> tab provides some configuration options for this purpose.</p><p><img src="bowman_november12.mspx_files/icf4.gif" alt="icf4.gif" width="363" border="0" height="411"></p><div style="margin-top: 3px; margin-bottom: 10px;"><a href="#top"><img src="bowman_november12.mspx_files/arrow_px_up.gif" alt="Top of page" width="7" border="0" height="9"></a><a class="topOfPage" href="#top">Top of page</a></div><a name="EKAAC"></a><h2>Some Special Circumstances</h2><p><b>VPN Usage</b>: If you're a VPN user and connect to a remote office, you should not use ICF. Turn it off before you start your VPN session.</p><p><b>File and Print Sharing</b>:
Some broadband providers offer connectivity for more than a single
computer and supply multiple public routable IPs. In this case,
computers are connected to a hub or switch (rather than a router or NAT
box) that connects to a cable or DSL modem. Since ICF disables file and
print sharing using TCP/IP, you may need an alternative method of
sharing files among your own computers. You can install an additional
network transport protocol such as IPX/SPX that will enable you to
transfer files between your computers. To install IPX/SPX, from the <b>Connection Properties </b>dialog box, select <b>Install</b>, then select <b>Protocol</b>, <b>Add</b> and then <b>NWLink IPX/SPX/NetBIOS Compatible Transport Protocol</b>.</p><p><b>Outgoing Windows Messenger Calls Behind ICF:</b>
If you are using Windows XP Professional, ensure you are using an
account with administrative privileges; otherwise outbound calls will
not work. (Users of Windows XP Home Edition are assigned the proper
administrative privileges by default.)</p><div style="margin-top: 3px; margin-bottom: 10px;"><a href="#top"><img src="bowman_november12.mspx_files/arrow_px_up.gif" alt="Top of page" width="7" border="0" height="9"></a><a class="topOfPage" href="#top">Top of page</a></div><a name="EHBAC"></a><h2>Who Does Not Need to Enable Internet Connection Firewall?</h2><p>If a computer is a <b>client</b> computer to an ICS (Internet Connection Sharing) host, do <b>not</b> enable ICF, but be sure you <b>do</b>
enable it on the host computer. If a computer is behind a NAT box or
router, don't enable ICF, because the inherent properties of NAT will
protect you. If you're in an enterprise/corporate environment, don't
enable ICF while logged into a domain at work because your IT staff
will have proper commercial firewalls in place on the network. In most
cases, user policies will prevent you from enabling ICF if you are
logged into a domain. If you've logged on at home using cached
credentials and enabled ICF, user policies will probably prevent you
from using ICF at work, but you will be able to use it at home while
not protected by the corporate firewall.</p><p><i>Barb Bowman enjoys
sharing her own experiences and insights into today's leading edge
technologies. She is a product development manager for AT&amp;T
Broadband Internet Services, but her views here are strictly personal. </i></p><br style="font-size: 0pt;" clear="all"><div style="margin-top: 16px; margin-bottom: 20px; width: 100%;"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tbody><tr><td><a href="#top"><img src="bowman_november12.mspx_files/arrow_px_up.gif" alt="Top of page" width="7" border="0" height="9"></a><a class="topOfPage" href="#top">Top of page</a></td></tr></tbody></table></div></div></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table><br style="overflow: hidden; line-height: 1px;" clear="all"><table id="msviFooter" width="100%" cellpadding="0" cellspacing="0"><tbody><tr valign="bottom"><td id="msviFooter2" style=""><div id="msviLocalFooter"><nobr><a href="http://go.microsoft.com/?linkid=317027" target="_top">Manage Your Profile</a> |</nobr><wbr><nobr><a href="http://go.microsoft.com/?linkid=2028376" target="_parent">Contact Us</a> |</nobr><wbr><nobr><a href="http://www.microsoft.com/windowsxp/newsletters/default.mspx?mg_id=10025" target="_top">Free Newsletter</a> |</nobr><wbr><nobr><a href="http://www.microsoft.com/windows/rss/" target="_parent">RSS Feeds</a></nobr></div><div id="msviGlobalFooter"><span dir="ltr">© 2010 Microsoft Corporation. All rights reserved.&nbsp;</span><nobr><a href="http://support.microsoft.com/contactus/?ws=mscom" target="_parent">Contact Us</a> |</nobr><wbr><nobr><a href="http://go.microsoft.com/?linkid=4412892" target="_parent">Terms of Use</a> |</nobr><wbr><nobr><a href="http://go.microsoft.com/?linkid=4412893" target="_parent">Trademarks</a> |</nobr><wbr><nobr><a href="http://go.microsoft.com/?linkid=4412894" target="_parent">Privacy Statement</a></nobr></div></td><td width="105" bgcolor="#6487db"><img src="bowman_november12.mspx_files/text.jpg" alt="Microsoft" title="" width="105" border="0" height="29"></td></tr></tbody></table><div style="display: none;"><script type="text/javascript">var gDomain="m.webtrends.com";var gDcsId="dcsjwb9vb00000c932fd0rjc7_5p3t";var gFpc="WT_FPC";if(document.cookie.indexOf(gFpc+"=")==-1){document.write("<SCR"+"IPT TYPE='text/javascript' SRC='"+"http"+(window.location.protocol.indexOf('https:')==0?'s':'')+"://"+gDomain+"/"+gDcsId+"/wtid.js"+"'><\/SCR"+"IPT>");}</script><script src="bowman_november12.mspx_files/wt.js" type="text/javascript"></script><noscript><img
border="0" name="DCSIMG" width="1" height="1"
src="http://m.webtrends.com/dcsjwb9vb00000c932fd0rjc7_5p3t/njs.gif?dcsuri=/nojavascript&WT.js=No"/></noscript></div><layer visibility="hide"><div style="display: none;"><img alt="" src="bowman_november12.mspx_files/trans_pixel.gif" vspace="0" width="0" border="0" height="0" hspace="0"></div></layer><script src="bowman_november12.mspx_files/broker-config.js"></script></body></html>